<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>When2Meet CSV Export Bookmarklet</title>
</head>
<body>
    <h1>When2Meet CSV Export Bookmarklet</h1>
    <p>Drag the link below to your bookmarks bar or right-click the link and add to bookmarks:</p>
    <a href="javascript:(function(){function%20getCSV(%7Bdelimiter%3D%22%2C%22%2CtimeFormat%3D%2212-hour%22%7D%3D%7B%7D)%7Bif(%5BPeopleNames%2CPeopleIDs%2CAvailableAtSlot%2CTimeOfSlot%5D.some(v%3D%3E!Array.isArray(v)%7Cv.length%3D%3D%3D0))%7Bconsole.error(%22Error%3A%20One%20or%20more%20required%20variables%20(PeopleNames%2C%20PeopleIDs%2C%20AvailableAtSlot%2C%20TimeOfSlot)%20are%20undefined%20or%20empty.%22)%3Breturn%3B%7Dlet%20result%3D%60Day%24%7Bdelimiter%7DTime%24%7Bdelimiter%7D%60%2BPeopleNames.join(delimiter)%2B%22%5Cn%22%3Bfor(let%20i%3D0%3Bi%3CAvailableAtSlot.length%3Bi%2B%2B)%7Blet%20slotExpr%3D%60%2F%2Fdiv%5B%40id%3D'GroupTime%24%7BTimeOfSlot%5Bi%5D%7D'%5D%2F%40onmouseover%60%3Blet%20slot%3Ddocument.evaluate(slotExpr%2Cdocument%2Cnull%2CXPathResult.STRING_TYPE%2Cnull).stringValue.match(%2F.*%22(.*)%22.*%2F)%3F.%5B1%5D%3Bif(!slot)%7Bconsole.error(%60Error%3A%20Could%20not%20retrieve%20or%20format%20time%20slot%20for%20index%20%24%7Bi%7D.%60)%3Bcontinue%3B%7Dlet%5Bday%2Ctime%5D%3Dslot.split(%22%20%22)%3Bif(timeFormat%3D%3D%3D%2224-hour%22)%7Btime%3DconvertTo24HourFormat(time)%3B%7Dresult%2B%3D%60%24%7Bday%7D%24%7Bdelimiter%7D%24%7Btime%7D%24%7Bdelimiter%7D%60%3Bresult%2B%3DPeopleIDs.map(id%3D%3EAvailableAtSlot%5Bi%5D.includes(id)%3F1%3A0).join(delimiter)%3Bresult%2B%3D%22%5Cn%22%3B%7Dconsole.log(result)%3Breturn%20result%3Bfunction%20convertTo24HourFormat(time12h)%7Bconst%5Btime%2Cmodifier%5D%3Dtime12h.split('%20')%3Blet%5Bhours%2Cminutes%2Cseconds%5D%3Dtime.split('%3A')%3Bif(hours%3D%3D%3D'12')%7Bhours%3D'00'%3B%7Dif(modifier%3D%3D%3D'PM')%7Bhours%3DparseInt(hours%2C10)%2B12%3B%7Dreturn%60%24%7Bhours%7D%3A%24%7Bminutes%7D%3A%24%7Bseconds%7D%60%3B%7D%7Dfunction%20downloadCSV(%7Bfilename%2Cdelimiter%3D%22%2C%22%2CtimeFormat%3D%2212-hour%22%7D%3D%7B%7D)%7Bconst%20urlParams%3Dnew%20URLSearchParams(window.location.search)%3Bconst%20uniqueCode%3DurlParams.keys().next().value%7C%7C'UNKNOWNCODE'%3Bconst%20timestamp%3Dnew%20Date().toISOString().slice(0%2C19).replace(%2F%5B%3A%5D%2Fg%2C%22%22)%3Bif(!filename)%7Bfilename%3D%60when2meet_%24%7BuniqueCode%7D_%24%7Btimestamp%7D.csv%60%3B%7Dconst%20content%3DgetCSV(%7Bdelimiter%2CtimeFormat%7D)%3Bif(!content)%7Bconsole.error(%22Error%3A%20Failed%20to%20generate%20CSV%20content.%22)%3Breturn%3B%7Dconst%20file%3Dnew%20Blob(%5Bcontent%5D%2C%7Btype%3A'text%2Fplain'%7D)%3Bconst%20link%3Ddocument.createElement(%22a%22)%3Blink.href%3DURL.createObjectURL(file)%3Blink.download%3Dfilename%3Blink.click()%3BURL.revokeObjectURL(link.href)%3B%7DdownloadCSV(%7Bdelimiter%3A%22%3B%22%2CtimeFormat%3A%2224-hour%22%7D)%3B%7D)();">When2Meet CSV Export Bookmarklet</a>
</body>
</html>
